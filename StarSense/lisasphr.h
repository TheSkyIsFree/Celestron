#ifndef __SKYSPHR_H__
#define __SKYSPHR_H__

//==============================================================================================================================
// standard header includes
//==============================================================================================================================
#include <string.h>                                             // std string and memory operations
#include <math.h>                                               // std math operations
#include "DmTypes.hpp"                                            // platform type and hardware specific definitions

#include "lisasolve.h"                                          // module specific includes



//******************************************************************************************************************************
//******                                         global defines and typedefs                                            ********
//******************************************************************************************************************************



//******************************************************************************************************************************
//******                                     exports of variables and functions                                         ********
//******************************************************************************************************************************



//==============================================================================================================================
// FUNC: LisaSphr_SetupProjection()                                                                                              
//==============================================================================================================================
// DESC:                                                                                                                        
//==============================================================================================================================
extern void LisaSphr_SetupProjection(
  double
    RaRad,
  double
    DecRad,
  double
    PScale
);



//==============================================================================================================================
// FUNC: LisaSphr_Project()                                                                                                      
//==============================================================================================================================
// DESC: given the rotation elements of the projection this routine performs the rotation of a field point at (RaRad, DecRad)   
//       and returns the (x,y) vector location of the projected field point rotation carries the center of the field to the     
//       +X-axis (X=1,Y=0,Z=0) if OrRad=0, then North is the positive z-direction, otherwise field is rotated by OrRad in a CCW 
//       direction the routine returns the Z-value of the projection                                                            
//==============================================================================================================================
extern double LisaSphr_Project(
  double
    RaRad,
  double
    DecRad,
  double
    *X,
  double
    *Y
);



//==============================================================================================================================
// FUNC: LisaSphr_DeProject()                                                                                                    
//==============================================================================================================================
// DESC: deprojects from catalog plate coordinates (X,Y) to (RA,Dec) projection must be set up before calling                   
//==============================================================================================================================
extern void LisaSphr_DeProject(
  double
    X,
  double
    Y,
  double
    *RaRad,
  double
    *DecRad
);



#ifdef __SKYSPHR_C__
//******************************************************************************************************************************
//******                                         local subsystem definitions                                            ********
//******************************************************************************************************************************

//==============================================================================================================================
// external header requirments for this module
//==============================================================================================================================



//==============================================================================================================================
// subsystem typedefs and defines
//==============================================================================================================================
typedef struct ProjectionTypeTg {
double
  RaRad,
  DecRad,
  OrientRad,
  CosRa,
  SinRa,
  CosDec,
  SinDec,
  PScale;
} ProjectionType;



typedef struct Vect3TypeTg {
  double
    X,
    Y,
    Z;
} Vect3Type;



typedef struct Vect3TypefTg {
  double
    X,
    Y,
    Z;
} Vect3Typef;



//==============================================================================================================================
// subsystem static function prototypes
//==============================================================================================================================



#endif //#ifdef __SKYSPHR_C__

#endif //#ifndef __SKYSPHR_H__
